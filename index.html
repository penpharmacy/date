<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏¢‡∏≤</title>
  <style>
    body { font-family: Tahoma, sans-serif; margin: 20px; background: linear-gradient(135deg, #a1c4fd, #c2e9fb); }
    h2 { color: #1a73e8; }
    label { display:block; margin-top:10px; font-weight:bold; }
    input { padding:8px; border-radius:8px; border:1px solid #1a73e8; }
    .days label { display:inline-block; margin-right:10px; font-weight:normal; }
    table { margin-top:20px; border-collapse:collapse; width:100%; max-width:600px; }
    th,td { border:1px solid #1a73e8; padding:10px; text-align:center; }
    th { background:#1a73e8; color:white; }
    td { background:#bbdefb; }
    .warning { color:#d32f2f; margin-top:10px; font-weight:bold; display:none; }
  </style>
</head>
<body>

<h2>üìÖ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏¢‡∏≤</h2>

<label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
<input type="date" id="startPicker">

<label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
<input type="date" id="endPicker">

<label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏°‡πá‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</label>
<input type="number" id="pillsPerWeek" value="7" min="1">

<label>‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤</label>
<div class="days">
  <label><input type="checkbox" value="0"> ‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</label>
  <label><input type="checkbox" value="1"> ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</label>
  <label><input type="checkbox" value="2"> ‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</label>
  <label><input type="checkbox" value="3"> ‡∏û‡∏∏‡∏ò</label>
  <label><input type="checkbox" value="4"> ‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</label>
  <label><input type="checkbox" value="5"> ‡∏®‡∏∏‡∏Å‡∏£‡πå</label>
  <label><input type="checkbox" value="6"> ‡πÄ‡∏™‡∏≤‡∏£‡πå</label>
</div>

<div id="warning" class="warning">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>

<table id="resultTable" style="display:none;">
  <tr>
    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</th>
    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</th>
    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤</th>
    <th>‡πÄ‡∏°‡πá‡∏î/‡∏ß‡∏±‡∏ô</th>
    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏°‡πá‡∏î‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ</th>
  </tr>
  <tr>
    <td id="daysCell"></td>
    <td id="weeksCell"></td>
    <td id="takeDaysCell"></td>
    <td id="pillsPerDayCell"></td>
    <td id="totalPillsCell"></td>
  </tr>
</table>

<button onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå / PDF</button>

<input type="hidden" id="startDay"><input type="hidden" id="startMonth"><input type="hidden" id="startYear">
<input type="hidden" id="endDay"><input type="hidden" id="endMonth"><input type="hidden" id="endYear">

<script>
function syncFromPicker(p,d,m,y){const v=document.getElementById(p).value;if(!v)return;const dt=new Date(v);document.getElementById(d).value=dt.getDate();document.getElementById(m).value=dt.getMonth();document.getElementById(y).value=dt.getFullYear()+543;}

function getSkipDays(){return Array.from(document.querySelectorAll('.days input:checked')).map(c=>+c.value);}

function calculate(){
  const sd=+startDay.value, sm=+startMonth.value, sy=+startYear.value-543;
  const ed=+endDay.value, em=+endMonth.value, ey=+endYear.value-543;
  const pillsPerWeek=+pillsPerWeekInput.value;
  if([sd,sm,sy,ed,em,ey,pillsPerWeek].some(isNaN))return;

  const start=new Date(sy,sm,sd), end=new Date(ey,em,ed);
  if(end<start){warning.style.display='block';resultTable.style.display='none';return;}
  warning.style.display='none';

  let totalDays=0, takeDays=0;
  const skip=getSkipDays();
  for(let d=new Date(start); d<=end; d.setDate(d.getDate()+1)){
    totalDays++;
    if(!skip.includes(d.getDay())) takeDays++;
  }

  const weeks=(totalDays/7).toFixed(2);
  const pillsPerDay=pillsPerWeek/(7-skip.length);
  const totalPills=Math.ceil(takeDays*pillsPerDay);

  daysCell.innerText=totalDays;
  weeksCell.innerText=weeks;
  takeDaysCell.innerText=takeDays;
  pillsPerDayCell.innerText=pillsPerDay.toFixed(2);
  totalPillsCell.innerText=totalPills;
  resultTable.style.display='table';
}

const pillsPerWeekInput=document.getElementById('pillsPerWeek');
const warning=document.getElementById('warning');
const resultTable=document.getElementById('resultTable');

const today=new Date().toISOString().split('T')[0];
startPicker.value=today; endPicker.value=today;

syncFromPicker('startPicker','startDay','startMonth','startYear');
syncFromPicker('endPicker','endDay','endMonth','endYear');
calculate();

startPicker.onchange=()=>{syncFromPicker('startPicker','startDay','startMonth','startYear');calculate();};
endPicker.onchange=()=>{syncFromPicker('endPicker','endDay','endMonth','endYear');calculate();};
pillsPerWeekInput.oninput=calculate;
document.querySelectorAll('.days input').forEach(c=>c.onchange=calculate);
</script>

</body>
</html>

